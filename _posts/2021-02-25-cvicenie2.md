---
layout: post
title:  "2. cvičenie 25.2.2021"
date:   2021-02-23 13:26:13 +0100
---
<!--
Na prvých dvoch prednáškach ste preberali základy numerických metód a vyjasnili ste si pojmy ako reprezentácia čísel v počítači, typy chýb pri riešení numerických úloh, korektnosť, podmienenosť úlohy a numerická stabilita. 
Na tomto cvičení si na príkladoch demonštrujeme niektoré z týchto poznatkov. <br>


Na začiatok si pripomeňme, že zdroje chýb pri numerických metódach sa  sa všeobecne delia na
- chyby vstupných dát (napr. chyby nameraných dát, ktoré potom zadávame do kódu, alebo chyba modelu reality)
- chyby metódy (truncation errors)
- zaokrúhľovacie chyby (roundoff errors).

<span style="color:DarkGreen"> <font size="+2"><b>Chyba metódy</b></font></span><br>
Odvodenie rádu metódy pre metódy aproximácie derivácie ste si ukázali na prednáške. V rámci opakovania si ukážeme, ako odvodiť rád metódy soprednej aproximácie prvej derivácie funkcie $f$:

{: .centering}
$f'(x)\sim\frac{f(x+h)-f(x)}{h}$

Rád metódy je rovný mocnine konečneho krátkeho kroku $h$, ktorý nahrádza nekonečne krátky krok. 
Urobíme Taylorov rozvoj členu $f(x+h)$: 

{: .centering}
$f'(x)\sim\frac{f(x+h)-f(x)}{h}\sim\frac{f(x)+h\frac{f'(x)}{1!}+h^2\frac{f''(x)}{2!}+h^3\frac{f'''(x)}{3!}-f(x)}{h}$

{: .centering}
$f'(x)\sim\frac{f(x+h)-f(x)}{h}\sim f'(x)+h\frac{f{''}(x)}{2!}+h^2\frac{f{'''}(x)}{3!}$

V tomto prípade vidíme, že metóda je prvého rádu, pretože člen s najnižšou mocninou, ktorý nám po Taylorovom rozvoji ostal je úmerný $h^1$. Je potrebné si uvedomiť, že krok $h$ je veľmi malý, preto členy s vyššími mocninami h  
TIP: Pri rozvoji si dajte pozor, do koľkých členov daný výraz rozviniete. Ak sa Vám všetky výrazy s $h$ pri aritmetických úpravach vyrušia, je potrebné sa vrátiť na začiatok, a rozvinúť Taylora do viacerých členov.

<span style="color:DarkGreen"><font size="+2"><b>Strojové epsilon</b></font></span><br>

Nasledujúce video obsahuje ukážku strojového epsilon v Matlabe a program na jeho odhad:<br>

<span style="color:DarkGreen"><b><font size="+2">Zaokrúhľovacie chyby</font> </b></span><br>
Na nasledujúcom príklade si ukážeme, ako sa zvýši relatívna chyba výpočtu, ak od seba odpočítame podobne veľké čísla. Majme čísla

{: .centering}
$x = 1.32483726$

{: .centering}
$y = 1.32483357$


Predstavme si, že tieto čísla môžeme ukladať len s presnosťou na 9 desatinných miest. 
Vezmime si napr. číslo x. To sme mohli získať zaokrúhlením čísel $1.324837255$, $1.324837256$, $1.324837257$, $1.324837258$, $1.324837259$, $1.324837260$,$1.324837261$,$1.324837262$, $1.324837263$, $1.324837264$ (a ďalšími číslami, ktoré by mali väčší počet desatinných miest než 10). Najvǎčší rozdiel by vznikol pri zaokrúhľovaní čísla $1.324837255$, pretože absolútna chyba
 (Keďže robíme len odhad, zanedbáme zaokrúhlenie z, ktoré by bolo pri našom odhade chyby zanedbateľné)
Relatívnu chybu odhadneme tým najväčśim rozdielom teda 

{: .centering}
$\delta x = 1.32483726-1.32483726=5\times10^{-9}$

Odhad relatívnej chyby potom môžeme vypočítať ako
{: .centering}
$\delta x = 1.32483726-1.32483726=5\times10^{-9}$

To isté platí pre y, t.j. $A(y) = 5\times10^{-9}$, $\delta y = 5\times10^{-9}$. Vykonajme teraz rozdiel 

{: .centering}
$x - y  = 1.32483726 - 1.32483357 = 4 \times 10^{-6}$

Odhad relatívnej chyba tohto rozdielu sa dá vypočítať ako
\delta(x-y)=\frac{A(x)+A(y)}{|x-y|}=\frac{d}{d}= 


Všimnime si, že v rámci jedinej opeŕacie sme prešli z relatívnej presnosti na oveľa nižšiu relatívnu prenosť !

-->
<span style="color:DarkGreen"><b><font size="+2">Numerická (ne)stabilita</font></b></span><br>

Príklad stabilnej a nestabilnej metódy si ukážeme na príklade padajúceho meteoritu v Matlabe. Úlohou je riešiť diferenciálnu rovnicu

{: .centering}
$\frac{\mathrm{d}v}{\mathrm{d}t}=-v$, 

s počiatočnou podmienkou $v(0)=1$. Táto rovnica (zjednoduchšene) opisuje brzdnú dráhu meteoritu v atmosfére, určuje teda zmenu rýchlosti $v$ v čase $t$.
Analytické riešenie tejto rovnice poznáme:

{: .centering}
$v(t) =\mathrm{exp}(-t)$.

My ju budeme riešiť pomocou dvoch rozdielnych numerických metód, a potom budeme mať možnosť si porovnať, ktorá z nich je numericky stabilnejšia.<br>


1. <b>Eulerova metóda</b> <br>
Nekonečne krátky časový krok $\mathrm{d}t$ nahraďme konečne krátkym malým krokom $h$:<br>


{: .centering}
$\frac{v(t)-v(t-h)}{h} = -v(t)$

Rýchlosť v čase $t+h$ budeme teda počítať ako

{: .centering}
$v(t)-v(t-h) = -v(t)h+v(t)$

1. <b>Dvojkroková metóda</b> <br>

Pri dvojkrokovej metóde sa derivácia aproximuje pomocou dvojnásobehného kroku $2h$:<br>

{: .centering}
$\frac{v(t)-v(t-2h)}{2h} = -v(t-h)$

Rýchlosť v čase $t+2h$ budeme teda počítať ako

{: .centering}
$v(t)= v(t-2h)-2h v(t-h)$
 
Všimnite si, že pri výpočte kroku v bode $v(t)$ sme využili hodnoty $v(t-h)$ aj $v(t-2h)$, narozdiel od Eulerovej metódy, kde sa využívalo len $v(t-h)$. 
Vo videu si ukážeme, aký výsledok dávajú obidva metódy, a aký je rozdiel v riešeniach pmocou jednotlivých metód. Prečítajte si pred tým ešte analytické vysvetlenie stability týchto algoritmov. Vidíte, že pri dvojkrokovej metóde chyba rastie s počtom krokom - to je numerická definícia nestability.
Vo videu si teraz názorne ukážeme rast tejto chyby: 
Video:


Výsledný program si môžete stiahnuť [->tu<-]().

Na záver si prečítajte aj [stručný prehľad o numerickej stabilite a výbere numerickej metódy](http://kfe.fjfi.cvut.cz/~matysma4/nme/cv02/priklad21.pdf).
<br>


<b>Dochádzková úloha</b><br>
Každý z Vás dostane do MS Teams chatu správu so zadaním úlohy. Vypracovanú úlohu mi pošlite naspäť v chate v súbore typu "uloha2_prijmeni.m", príp. skopírujte text kódu priamo do chatu a pošlite ako správu (ak sme sa už inak nedohodli vopred).
PRE ZÍSKANIE BODU ZA ÚLOHU, ODOVZDAJTE ÚLOHU DO STREDY 3.3. do 23:59:59!

