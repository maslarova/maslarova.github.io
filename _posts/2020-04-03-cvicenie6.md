---
layout: post
title:  "6. cvičenie 4.3.2020-PRIPRAVUJE SA"
date:   2020-03-31 13:26:13 +0100
---
<!---
<font size="5"> <span style="color:green"><b>Úlohy za dochádzku 3.4. </b></span> </font> <font size="4">  <span style="color:red">---DEADLINE 10.4.---</span> </font><br />

**Úloha 1:**<br />
Vašou úlohou bude nájsť aproximáciu funkcie zadanú bodmi $x_i$ a príslušnými funkčnými hodnoty $y_i$, kde $i\in$ {$0,1,..25$}, pomocou metódy najmenších štvorcov. Dáta si stiahnite tu -> [dáta](http://maslarova.github.io/cvicenie6/data_exp.txt). Hodnoty $x_i$  sú v prvom stĺpci, hodnoty $y_i$ sú v druhom stĺpci. 

Hodnoty aproximujte funkciou

{: .centering}
$y(x) = B A^{x}$.

V tomto prípade vystupuje premenná $x$ ako exponent, $A$ a $B$ sú reálne koeficienty, ktoré hľadáme. Otázkou je, ako z tejto funkcie zostrojiť vhodnú funkciu pre minimalizáciu. Vhodným prístupom je zlogaritmovať obe strany: 

{: .centering}
$\mathrm{ln}~y =\mathrm{ln} (B\cdot A^{x})=\mathrm{ln}~B + \mathrm{ln}~A^{x} = \mathrm{ln}~B+ x\cdot \mathrm{ln}  A$

Priraďme $b= \mathrm{ln}~B$ a  $a= \mathrm{ln}~A$. Tým si vzorec uľahčíme a budeme minimalizovať funkciu s koeficientami $a$ a $b$. Koeficienty $A$ a $B$ potom môžeme dopočítať z $A= e^a$ a $B = e^b$ 
dostávame 

{: .centering}
$\mathrm{ln}~y =b + x\cdot a$

{: .centering}
$S_1 = \sum_{i=0}^{25} (\mathrm{ln}~y_i - b + a^{x_i} )^2$

Minimalizačnú funkciu síce máme, treba si však uvedomiť jednu vec. Vo vzorci vystupuje výraz $\mathrm{ln}~y_i$. Pôvodne sme mali však minimalizovať výraz s y_i. To môže viesť ku nepresnejšieho Presnejší odhad nám môže poskytnúť zvoliť vhodn=

{: .centering}
$S_2 = \sum_{i=0}^{25} (y_i \cdot (\mathrm{ln}~y_i - b + a^{x_i} )^2)$

Vašou úlohou bude:
- Odvodte sústavu lineárnych rovníc pre koeficienty $a$ a $b$. Sústavu získate hľadaním minima funkcie $S_1$ a funkcie $S_2$ v $a$, $b$.
- Implementujte túto metódu v Matlabe (príp. inom jazyku). Nepoužívajte pritom na implementované metódy v Matlabe, s výnimkou riešenia sústavy lineárnych rovníc pre  $a$ a $b$. Musíte teda napísať maticu, ktorá rieši lineárnu sústavu pre koeficienty $a$, $b$ počítaním parciálnych derivácii funkcie $S_1$. 
- Overte túto metódu na dátach $x_i$ a $y_i$. Vykreslite do grafu 
- Pošlite mi do MS Teams odvodenie matíc (výpočet na papieri, Latex,.. )


Užitočné príkazy v Matlabe: <br />
[log](https://www.mathworks.com/help/matlab/ref/log.html)- prirodzený logaritmus <br />
[sum](https://www.mathworks.com/help/matlab/ref/sum.html)- príkaz, ktorý sčíta všetky prvky vektoru, napr. sum(Z)=6 pre Z = [1,2,3], pretože 1+2+3=6.  <br />

<br />
**Úloha 2:**<br />
Odpovedzte na otázku, ktorú ste dostali do chatu. 
<br />
<br />

<br />
<font size="5">  <span style="color:green"><b>Materiály ku cvičeniu: Aproximácia funkcií</b></span></font>  
<br />
<font size="4">  <span style="color:green"><b>Úvod do aproximácie-opakovanie</b></span></font>  <br />
Cieľom **aproximácie funkcie** je nájsť funkciu v nejakej dobre definovanej triede funkcií (polynómy, racionálna lomená funkcia,...), ktorá dobre aproximuje našu funkciu. Predpokladajme teda, že máme definované nejaké 
body a funkčné hodnoty v týchto bodoch (príp. derivácie a ďalšie parametre). Na základe týchto údajov chceme zistiť funkčný predpis, ktorý dobre aproximuje chovanie v týchto bodoch. <br />
<br /> Pokiaľ chceme, aby vybraná funkcia prechádzala zadanými bodmi, využívame **interpoláciu**. Pri interpolácii hľadáme aproximáciu funkčnej hodnoty iba vo vnútri intervalu, v ktorom interpolujeme. 
Pri **extrapolácii** naopak hľadáme funkčnú hodnotu mimo tento interval. Extrapolácia môže byť veľmi nepresná, pretože ťažko zaručíme, že mimo daný interval nemá funkcia úplne iné chovanie než v ňom. 
Pri **minimalizácii** (napr. metóda najmenších štvorcov) nemusí aproximačná funkcia prechádzať zadanými dátami. Je založená na minimalizácii rozdielu medzi pôvodnou funkciou a aproximáciou.
<font size="4">  <span style="color:green"><b> Čebyševova aproximácia </b></span></font>  <br />
<font size="4">  <span style="color:green"><b> Minimalizácia-najmenšie štvorce</b></span></font>  <br />
Majme hodnoty funkcie $x_0, x_1,..., x_n$ a $y_0,y_1,... y_n$, $n \in \mathbb{N}$. Chceme určiť nejaký funkčný predpis, ktorý by dobre aproximoval vývoj týchto bodov. Z minimalizačných metód si bližšie metódu najmenších štvorcov. Táto metóda je veľmi bežná, a pravdepodobne ste sa s ňou už i stretli, keď ste nejaké, napr. experimentálne dáta fitovali vhodnou funkciou. 

Ukážme si najprv túto metódu na lineárnej funkcii. 
Máme dáta 

  <table align="center">
        <tr >
            <td>$i$</td>
            <td>1</td>
            <td>2</td>
            <td>3</td>
            <td>4</td>
            <td>5</td>
        </tr>

        <tr >
            <td>$x_i$</td>
            <td>0</td>
            <td>1</td>
            <td>3</td>
            <td>5</td>
            <td>6</td>
        </tr>

        <tr >
            <td>$y_i$</td>
            <td>5</td>
            <td>3</td>
            <td>3</td>
            <td>2</td>
            <td>1</td>
        </tr>
    </table>

Na obrázku vidíte funkciu $f(x)  = ax+b$, kde $a=0,54$ a $b=4,42$ (zakrúhlene na 2 desatinné miesta). 
![](http://maslarova.github.io/cvicenie6/lin_fun_sum.png?raw=true)
Hodnoty $s_1, s_2, s_3, s_4, s_5$, sú vzdialenosti bodov $y_0,y_1,... y_n$ od funkcie f(x). 
Koeficienty je možné získať tak, že minimalizujeme súčet druhých mocnín týchto vzdialeností od $f(x)$. Koeficienty $a ,b$ ktoré majú minimum . 

Minimalizujeme teda  

{: .centering}
$S= $

Poďme si teda túto funkciu zderivovať:

{: .centering}
$\frac{\partial S}{\partial a}  = \sum_{i=0}^{25} (y_i \cdot (\mathrm{ln}~y_i - b + a^{x_i} )^2)$

{: .centering}
$\frac{\partial S}{\partial b}  = \sum_{i=0}^{25} (y_i \cdot (\mathrm{ln}~y_i - b + a^{x_i} )^2)$





Pripomeňme si, že aproximačná funkcia nemusí prechádzať bodmi $y_0,y_1,... y_n$. 

![](http://maslarova.github.io/cvicenie6/lin_fun_sum.png?raw=true)



Keď už vieme, ako dáta aproximovať, ponúka sa otázka, ako vybrať vhodnú aproximáciu pre dané dáta. Pokiaľ máme napr. namerané dáta, a že závislosť. 

V realite sme ale častokrát postavení pred hodnoty, o ktorých . Jednou možnosťou je vykresliť si graficky body a odhadnúť závislosť "by oko". Niekedy to funguje dobre, ale niekedy nás to môže naviesť zlým smerom. 
Problém 
Určitú nápovedu nám môže dať 
Ako dobrý príklad na problém s aproximáciou si môžete nájsť v tomto článku. 
Podobný prípad sa stal kedysi s

Pri  zobrať i kontext údajov.  

![](http://maslarova.github.io/cvicenie6/lin_fun_sum.png?raw=true)
-->
